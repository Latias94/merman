# Sequence Upstream Test Coverage (Mermaid@11.12.2)

This document tracks which upstream Mermaid `sequenceDiagram` tests are covered in `merman` via:

- snapshot fixtures under `fixtures/sequence/*.mmd` (goldens generated by `cargo run -p xtask -- update-snapshots`)
- Rust unit tests under `crates/merman-core/src/lib.rs`
- upstream SVG baselines under `fixtures/upstream-svgs/sequence/*.svg` (generated by `cargo run -p xtask -- gen-upstream-svgs --diagram sequence`)
- SVG DOM compare via `cargo run --release -p xtask -- compare-sequence-svgs --check-dom --dom-mode parity-root --dom-decimals 3`

Scope: Mermaid tag `@11.12.2`.

## External regression cases

These fixtures are sourced from downstream renderer reports (outside Mermaid's own test suite) and
are parity-gated against upstream SVG baselines:

- mmdr test fixture (basic): `fixtures/sequence/mmdr_tests_sequence_sequence_basic.mmd`
- mmdr test fixture (frames): `fixtures/sequence/mmdr_tests_sequence_sequence_frames.mmd`
- mmdr docs comparison sources:
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_collab.mmd`
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_loops.mmd`
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_notes.mmd`
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_autonumber.mmd`
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_oauth.mmd`
  - `fixtures/sequence/mmdr_docs_comparison_sources_sequence_microservice.mmd`
- mmdr bench fixtures:
  - `fixtures/sequence/mmdr_benches_fixtures_sequence.mmd`
  - `fixtures/sequence/mmdr_benches_fixtures_sequence_medium.mmd`
  - `fixtures/sequence/mmdr_benches_fixtures_expanded_sequence_long_labels.mmd`
  - `fixtures/sequence/mmdr_benches_fixtures_expanded_sequence_frames_notes.mmd`

Reference: `docs/alignment/EXTERNAL_FIXTURES.md`.

## Cypress rendering fixtures

Source:

- `repo-ref/mermaid/cypress/integration/rendering/sequencediagram.spec.js`
- `repo-ref/mermaid/cypress/integration/rendering/sequencediagram-v2.spec.js`

These fixtures are parity-gated against upstream SVG baselines (DOM parity, root viewport mode):

- `fixtures/sequence/upstream_cypress_sequencediagram_spec_example_001.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_sequence_diagram_when_usemaxwidth_is_false_059.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_sequence_diagram_with_actor_creation_and_destruc_010.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_sequence_diagram_with_basic_actor_creation_and_d_009.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_sequence_diagram_with_par_over_008.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_single_and_nested_opt_with_long_test_overflowing_037.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_single_and_nested_opt_with_long_test_wrapping_038.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_a_single_and_nested_rects_036.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_render_rect_around_and_inside_opts_041.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_spec_should_support_actor_links_and_properties_experimental_use_with_052.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_handle_complex_interactions_between_different_participant_013.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_a_sequence_diagram_when_usemaxwidth_is_false_030.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_complex_sequence_with_all_features_010.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_different_participant_types_with_alternative_flows_016.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_different_participant_types_with_notes_and_loops_015.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_different_participant_types_with_wrapping_text_017.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_parallel_processes_with_different_participant_type_014.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_with_different_font_settings_009.mmd`
- `fixtures/sequence/upstream_cypress_sequencediagram_v2_spec_should_render_with_wrapped_messages_and_notes_011.mmd`

## `sequenceDiagram.spec.js`

Source: `repo-ref/mermaid/packages/mermaid/src/diagrams/sequence/sequenceDiagram.spec.js`

### Parsing / DB-level behavior

- basic definition: `fixtures/sequence/basic.mmd`
- title + accessibility (`title:`, `accTitle:`, `accDescr:`, `accDescr{...}`):
  - `fixtures/sequence/title_and_accdescr_multiline.mmd`
  - `fixtures/sequence/upstream_title_without_colon_spec.mmd`
  - `fixtures/sequence/upstream_accessibility_single_line_spec.mmd`
- `-` / `=` in actor ids: `fixtures/sequence/actor_ids_dashes_and_equals.mmd`
- participant / actor aliasing:
  - `fixtures/sequence/upstream_alias_participants_spec.mmd`
  - `fixtures/sequence/upstream_alias_mixed_actor_participant_spec.mmd`
- repeated participant declarations dedupe actors: `fixtures/sequence/upstream_duplicate_participants_single_actor_spec.mmd`
- signal type variants: `fixtures/sequence/arrows_variants.mmd`
- activation:
  - `activate` / `deactivate`: `fixtures/sequence/activation_explicit.mmd`
  - inline `+` / `-` activation syntax + stacked activations: `fixtures/sequence/activation_stacked.mmd`
  - deactivate inactive participant must fail: unit test `parse_diagram_sequence_deactivate_inactive_participant_fails_like_upstream` in `crates/merman-core/src/lib.rs`
- comments and blank lines: `fixtures/sequence/comments_and_blank_lines.mmd`
- leading indentation on statements: `fixtures/sequence/upstream_leading_spaces_spec.mmd`
- semicolon statement separators: `fixtures/sequence/semicolons_and_comments.mmd`
- special characters truncated by `;` and `#`: `fixtures/sequence/special_characters.mmd`
- no-label `loop` / `opt` / `alt` / `par`: `fixtures/sequence/no_label_blocks.mmd`
- indented block statements (`loop` + `end`): `fixtures/sequence/upstream_indented_loop_block_spec.mmd`
- `rect` blocks (including nested):
  - `fixtures/sequence/upstream_rect_block_spec.mmd`
  - `fixtures/sequence/upstream_nested_rect_blocks_spec.mmd`
- alt with multiple `else` branches: `fixtures/sequence/upstream_alt_multiple_elses_spec.mmd`
- `critical` blocks (with/without `option`): 
  - `fixtures/sequence/upstream_critical_without_options_spec.mmd`
  - `fixtures/sequence/upstream_critical_with_options_spec.mmd`
- `break` blocks: `fixtures/sequence/upstream_break_spec.mmd`
- `par` with multiple `and` branches: `fixtures/sequence/upstream_par_multiple_ands_spec.mmd`
- `par_over` blocks: `fixtures/sequence/upstream_par_over_spec.mmd`
- `<br>` variants + `wrap:` / `nowrap:` prefixes: `fixtures/sequence/html_br_variants_and_wrap.mmd`
- wrap directive `%%{wrap}%%`: `fixtures/sequence/wrap_directive_default.mmd`
- init directive `%%{init: { config: ... } }%%` sets `sequence.wrap`: `fixtures/sequence/upstream_sequence_init_config_wrap_spec.mmd`
- note placement forms: `fixtures/sequence/notes_placements.mmd`
- boxes: `fixtures/sequence/box_variants.mmd`
- create / destroy:
  - create: `fixtures/sequence/create_simple.mmd`
  - destroy: `fixtures/sequence/destroy_simple.mmd`
  - create + destroy same actor id: `fixtures/sequence/create_destroy_same_actor.mmd`
- links / properties / details: `fixtures/sequence/links_and_properties.mmd`
- trailing colon message content: `fixtures/sequence/trailing_colon_empty_message.mmd`
- extended participant syntax / `type` override:
  - type parsing: `fixtures/sequence/participant_types.mmd`
  - extended syntax quote styles + whitespace: `fixtures/sequence/upstream_extended_participant_quote_styles_spec.mmd`
  - mixed implicit/explicit participants with extended syntax + activation: `fixtures/sequence/upstream_extended_participant_mixed_types_spec.mmd`
  - mixed types and invalid configs: unit tests under `crates/merman-core/src/lib.rs`
- `autonumber` statements: `fixtures/sequence/autonumber_variants.mmd`

### Rendering-only / deferred (not part of headless parsing parity)

- `showSequenceNumbers()` depends on `renderer.draw(...)` side effects in upstream tests.
- bounds calculation, APA rendering, actor mirror behavior, and `svgDraw` unit tests.

## Docs-derived parser+render fixtures

Source: `repo-ref/mermaid/docs/syntax/sequenceDiagram.md`

- basic example arrows (`->>`, `-->>`, `-)`): `fixtures/sequence/upstream_docs_sequence_basic_example.mmd`
- explicit participants and order: `fixtures/sequence/upstream_docs_sequence_participants_order.mmd`
- explicit `actor` statements: `fixtures/sequence/upstream_docs_sequence_actors_basic.mmd`
- `as` aliases: `fixtures/sequence/upstream_docs_sequence_aliases_basic.mmd`
- create/destroy example (participants + actors): `fixtures/sequence/upstream_docs_sequence_create_destroy_example.mmd`
- boxes/grouping: `fixtures/sequence/upstream_docs_sequence_box_groups_example.mmd`
- `<br/>` in message + note: `fixtures/sequence/upstream_docs_sequence_note_with_br.mmd`
- `<br/>` in participant label: `fixtures/sequence/upstream_docs_sequence_actor_label_with_br.mmd`
- `loop` example: `fixtures/sequence/upstream_docs_sequence_loop_every_minute.mmd`
- `alt` + `opt` example: `fixtures/sequence/upstream_docs_sequence_alt_and_opt_example.mmd`
- nested `rect` blocks + mixed whitespace: `fixtures/sequence/upstream_docs_sequence_rect_nested_example.mmd`
- entity code escaping (`#9829;`, `#infin;`): `fixtures/sequence/upstream_docs_sequence_entity_codes_example.mmd`
- `autonumber` full example: `fixtures/sequence/upstream_docs_sequence_autonumber_example.mmd`

Additional imported blocks (complex / type variants / frames):

- participant type shapes:
  - `fixtures/sequence/upstream_docs_sequencediagram_boundary_008.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_control_010.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_entity_012.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_database_014.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_collections_016.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_queue_018.mmd`
- activations example variants:
  - `fixtures/sequence/upstream_docs_sequencediagram_activations_030.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_activations_032.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_activations_034.mmd`
- notes + placement variants:
  - `fixtures/sequence/upstream_docs_sequencediagram_notes_036.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_notes_038.mmd`
- frames:
  - `fixtures/sequence/upstream_docs_sequencediagram_parallel_052.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_critical_region_059.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_break_062.mmd`
- comments + advanced menu syntax:
  - `fixtures/sequence/upstream_docs_sequencediagram_comments_069.mmd`
  - `fixtures/sequence/upstream_docs_sequencediagram_advanced_menu_syntax_080.mmd`
