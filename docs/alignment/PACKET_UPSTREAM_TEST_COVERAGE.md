# Packet Upstream Test Coverage (Mermaid@11.12.2)

This document tracks which upstream Mermaid packet diagram parser tests are covered in `merman` via:

- snapshot fixtures under `fixtures/packet/*.mmd` (goldens generated by `cargo run -p xtask -- update-snapshots`)
- Rust unit tests under `crates/merman-core/src/diagrams/packet.rs`

Scope: Mermaid tag `@11.12.2`.

Source: `repo-ref/mermaid/packages/mermaid/src/diagrams/packet/packet.spec.ts`

- `packet-beta` header: `fixtures/packet/upstream_packet_beta_header_spec.mmd`
- `packet` header: `fixtures/packet/upstream_packet_header_spec.mmd`
- diagram with title + accessibility + data: `fixtures/packet/upstream_packet_data_and_title_spec.mmd`
- single-bit blocks (`11: "single"`): `fixtures/packet/upstream_packet_single_bits_spec.mmd`
- bit counts (`+8`, `+16`): `fixtures/packet/upstream_packet_bit_counts_spec.mmd`
- split across multiple rows: `fixtures/packet/upstream_packet_split_multiple_rows_spec.mmd`
- split when cut at exact length: `fixtures/packet/upstream_packet_split_exact_length_spec.mmd`
- contiguity/end/zero-bit error cases: `crates/merman-core/src/diagrams/packet.rs:370`

Docs-derived fixtures (rendered via official Mermaid CLI, version-pinned):

Source: `repo-ref/mermaid/packages/mermaid/src/docs/syntax/packet.md`

- TCP Packet example (frontmatter title): `fixtures/packet/upstream_packet_docs_tcp_packet_example.mmd`
- UDP Packet example: `fixtures/packet/upstream_packet_docs_udp_packet_example.mmd`
- bit-count mixing (`+<count>` + manual range): `fixtures/packet/upstream_packet_docs_bit_count_mix_spec.mmd`

Upstream SVG baselines:

- `fixtures/upstream-svgs/packet/upstream_packet_docs_tcp_packet_example.svg`
- `fixtures/upstream-svgs/packet/upstream_packet_docs_udp_packet_example.svg`
- `fixtures/upstream-svgs/packet/upstream_packet_docs_bit_count_mix_spec.svg`

Compare report:

- `cargo run -p xtask -- compare-packet-svgs --check-dom --dom-mode parity-root --dom-decimals 3`

## Cypress rendering specs

Source: `repo-ref/mermaid/cypress/integration/rendering/packet.spec.ts`

These fixtures are extracted from Cypress browser rendering specs (`imgSnapshotTest`) and are
parity-gated against upstream SVG baselines:

- Imported fixtures: `fixtures/packet/upstream_cypress_*.mmd` (5 fixtures)
- Import tool: `cargo run -p xtask -- import-upstream-cypress --diagram packet --with-baselines --complex --limit 30`
- Baselines: `fixtures/upstream-svgs/packet/upstream_cypress_*.svg`
- SVG DOM compare: `cargo run --release -p xtask -- compare-packet-svgs --check-dom --dom-mode parity-root --dom-decimals 3`
