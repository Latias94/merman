# GitGraph Upstream Test Coverage (Mermaid@11.12.2)

This document tracks which upstream Mermaid GitGraph parser tests are covered in `merman` via:

- snapshot fixtures under `fixtures/gitgraph/*.mmd` (goldens generated by `cargo run -p xtask -- update-snapshots`)
- Rust unit tests under `crates/merman-core/src/diagrams/git_graph.rs`

Rendering parity for the same fixture set is tracked separately via:

- upstream SVG baselines under `fixtures/upstream-svgs/gitgraph/*.svg`
- the DOM parity compare report:
  - `cargo run -p xtask -- compare-gitgraph-svgs --check-dom --dom-mode parity --dom-decimals 3`
  - root viewport (`viewBox` / `style max-width`) parity:
    - `cargo run -p xtask -- compare-gitgraph-svgs --check-dom --dom-mode parity-root --dom-decimals 3`

Scope: Mermaid tag `@11.12.2`.

## `gitGraph.spec.ts`

Source: `repo-ref/mermaid/packages/mermaid/src/diagrams/git/gitGraph.spec.ts`

### Basic parsing and headers

- `gitGraph:` header + one `commit`: unit test `should_handle_gitgraph_definition_and_defaults` in `crates/merman-core/src/diagrams/git_graph.rs`
- direction headers (`gitGraph TB:` / `gitGraph BT:`): unit test `should_handle_set_direction_tb_and_bt` in `crates/merman-core/src/diagrams/git_graph.rs`
- snapshot coverage for header/direction detection and output shape:
  - `fixtures/gitgraph/upstream_header_default.mmd`
  - `fixtures/gitgraph/upstream_direction_tb.mmd`
  - `fixtures/gitgraph/upstream_direction_bt.mmd`

### Commit statements and parameter variants

- commit message syntaxes (`commit "..."` and `commit msg: "..."`): unit test `should_handle_commit_with_args_and_message_variants` in `crates/merman-core/src/diagrams/git_graph.rs`
- custom commit `id`, `tag`, `type` (and mixed ordering): unit test `should_handle_commit_with_args_and_message_variants` in `crates/merman-core/src/diagrams/git_graph.rs`
- three straight commits: unit test `should_handle_three_straight_commits` in `crates/merman-core/src/diagrams/git_graph.rs`
- snapshot coverage for mixed commit variants:
  - `fixtures/gitgraph/upstream_commits_spec.mmd`

### Branching and checkout/switch

- branch creation + `checkout` / `switch`: unit tests `should_checkout_and_switch_branch` and `should_add_commits_to_checked_out_branch` in `crates/merman-core/src/diagrams/git_graph.rs`
- `switch` flow with commits and merge: `fixtures/gitgraph/upstream_switch_commit_merge_spec.mmd`
- quoted branch names: covered by unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_branches_and_order.mmd`
- branch name character coverage (including `_ - . /` and numeric prefixes): unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_branches_and_order.mmd`
- branch ordering (`order:`) and branch array sorting behavior: unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_branches_and_order.mmd`

### Merge behavior

- merge noop scenario and merge with 2 parents: unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_merges_spec.mmd`
- merge tags / custom ids / override types: unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_merges_spec.mmd`
- merge error cases (unknown branch, same branch, no commits, duplicate id, same heads): unit tests under `crates/merman-core/src/diagrams/git_graph.rs`

### Cherry-pick behavior

- cherry-pick commits (default tag / custom tag / empty tag): 
  - `fixtures/gitgraph/upstream_cherry_pick_default_tag_spec.mmd`
  - `fixtures/gitgraph/upstream_cherry_pick_custom_tag_spec.mmd`
  - `fixtures/gitgraph/upstream_cherry_pick_empty_tag_spec.mmd`
- cherry-pick merge commits with explicit `parent:` and tag handling (including empty tag): unit tests (see `crates/merman-core/src/diagrams/git_graph.rs`) and snapshots:
  - `fixtures/gitgraph/upstream_cherry_pick_merge_commits.mmd`
- cherry-pick error cases (missing parent for merge commit, invalid parent): unit tests under `crates/merman-core/src/diagrams/git_graph.rs`

### Accessibility and warnings

- `accTitle` / `accDescr` (single-line and multi-line block): unit test `should_handle_accessibility_title_and_description` in `crates/merman-core/src/diagrams/git_graph.rs` and snapshots:
  - `fixtures/gitgraph/upstream_accessibility_single_line_accdescr_spec.mmd`
  - `fixtures/gitgraph/upstream_accessibility_and_warnings.mmd`
- unsafe ids (`__proto__`, `constructor`) as commit ids / branch names: unit test `should_work_with_unsafe_properties_as_ids_and_branch_names` in `crates/merman-core/src/diagrams/git_graph.rs` and snapshot:
  - `fixtures/gitgraph/upstream_unsafe_id_branch_and_commit_spec.mmd`
- duplicate commit id warning: unit test `should_log_warning_when_two_commits_have_same_id` in `crates/merman-core/src/diagrams/git_graph.rs` and snapshot:
  - `fixtures/gitgraph/upstream_accessibility_and_warnings.mmd`

## Upstream Syntax Docs

Source: `repo-ref/mermaid/docs/syntax/gitgraph.md`

- hiding branch names and lines:
  - `fixtures/gitgraph/upstream_docs_gitgraph_hiding_branch_names_and_lines_022.mmd`
- theme variants (base/default/forest/neutral):
  - `fixtures/gitgraph/upstream_docs_gitgraph_base_theme_046.mmd`
  - `fixtures/gitgraph/upstream_docs_gitgraph_forest_theme_048.mmd`
  - `fixtures/gitgraph/upstream_docs_gitgraph_default_theme_050.mmd`
  - `fixtures/gitgraph/upstream_docs_gitgraph_neutral_theme_054.mmd`

## Cypress rendering specs

Source: `repo-ref/mermaid/cypress/integration/rendering/gitGraph.spec.js`

These fixtures are extracted from Cypress browser rendering specs (`renderGraph`) and are
parity-gated against upstream SVG baselines:

- Imported fixtures: `fixtures/gitgraph/upstream_cypress_*.mmd` (30 fixtures)
- Import tool: `cargo run -p xtask -- import-upstream-cypress --diagram gitgraph --with-baselines --complex --limit 30`
- Baselines: `fixtures/upstream-svgs/gitgraph/upstream_cypress_*.svg`
- SVG DOM compare: `cargo run --release -p xtask -- compare-gitgraph-svgs --check-dom --dom-mode parity-root --dom-decimals 3`
