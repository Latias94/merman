# C4 Layout Upstream Test Coverage (Mermaid@11.12.2)

This document tracks which **upstream Mermaid C4 layout behaviors** are covered in `merman` via:

- layout snapshots under `fixtures/c4/*.layout.golden.json` (generated by
  `cargo run -p xtask -- update-layout-snapshots --diagram c4`)
- end-to-end upstream SVG baselines under `fixtures/upstream-svgs/c4/*.svg` (generated by
  `cargo run -p xtask -- gen-upstream-svgs --diagram c4`)
- the automated DOM parity report:
  `cargo run -p xtask -- compare-c4-svgs --check-dom --dom-mode parity --dom-decimals 3`

Scope: Mermaid tag `@11.12.2`.

## Upstream sources (layout algorithm)

Mermaid’s C4 layout math is implemented in:

- `repo-ref/mermaid/packages/mermaid/src/diagrams/c4/c4Renderer.js`

Unlike many other Mermaid diagrams, the C4 renderer does not have a dedicated, granular “layout
unit test” suite. For parity work we treat the upstream SVG baselines as authoritative and use
layout snapshots to localize diffs to “layout vs. SVG”.

## Covered behaviors (Phase 1 slice)

The current C4 layout implementation in `merman-render` is covered by the following fixture sets:

- Basic placement + bounds:
  - `fixtures/c4/basic.mmd`
  - `fixtures/c4/a11y.mmd`
- Boundary recursion + nested placement:
  - `fixtures/c4/upstream_boundary_spec.mmd`
  - `fixtures/c4/nesting_updates.mmd`
- Shape/boundary wrapping rules (row limits and widthLimit):
  - `fixtures/c4/upstream_update_layout_config_invalid_values_spec.mmd`
  - `fixtures/c4/upstream_boundary_type_injection_spec.mmd`

For detailed expected fields and invariants, see:

- `docs/alignment/C4_LAYOUT_MINIMUM.md`

